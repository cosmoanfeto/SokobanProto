# Serve gzip compressed CSS and JS files if they exist
# and the client accepts gzip.
RewriteCond %{HTTP:Accept-encoding} gzip
RewriteCond %{REQUEST_FILENAME}\.gz -s
RewriteRule ^(.*)\.js $1\.js\.gz [QSA]
RewriteRule ^(.*)\.css $1\.css\.gz [QSA]

# Serve correct content types, and prevent mod_deflate double gzip.
RewriteRule \.js\.gz$ - [T=text/javascript,E=no-gzip:1]
RewriteRule \.css\.gz$ - [T=text/css,E=no-gzip:1]

# Serve correct encoding type.
Header set Content-Encoding gzip
